<form [formGroup]="formulario" >
  <div class="row my-3">
    <div class="col-md-6">
      <label class="control-label" for="nivel">Nivel:</label>
      <p-dropdown id="nivel" class="form-control" formControlName="nivel" [options]="catalogoNiveles"
                  placeholder="Seleccionar el nivel" [filter]="true" filterBy="label">
      </p-dropdown>
    </div>
    <div class="col-md-6">
      <label class="control-label" for="delegacion">Delegación:</label>
      <p-dropdown id="delegacion" class="form-control" formControlName="delegacion" [options]="catalogoDelegaciones"
                  placeholder="Seleccionar la delegación" [filter]="true" filterBy="label">
      </p-dropdown>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-6">
      <label class="control-label" for="velatorio">Velatorio:</label>
      <p-dropdown id="velatorio" class="form-control" formControlName="velatorio" [options]="catalogoVelatorios"
                  placeholder="Seleccionar el velatorio" [filter]="true" filterBy="label">
      </p-dropdown>
    </div>
    <div class="col-md-6">
  <!--                    (onSelect)="seleccionaPanteon($event)"  [suggestions]="panteonServicioFiltrados"-->
  <!--                    (completeMethod)="filtrarPateon($event)"-->
      <label class="control-label" for="ordenEntrada">Orden de entrada (ODE):</label>
      <p-autoComplete id="ordenEntrada"  class="form-control" formControlName="ordenEntrada"
                      autocomplete="000000"
                      [showEmptyMessage]="true" [style]="{'width':'100%'}" [minLength]="3" [maxlength]="50"
                      class="p-autocomplete" placeholder="Ingresa la orden de entrada"
                      [inputStyle]="{'width' : '100%','font-style' : 'normal','font-weight' : '400','font-size' : '14px'}">
      </p-autoComplete>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-6">
      <!--                    (onSelect)="seleccionaPanteon($event)"  [suggestions]="panteonServicioFiltrados"-->
      <!--                    (completeMethod)="filtrarPateon($event)"-->
      <label class="control-label" for="ordenEntrada">Proveedor:</label>
      <p-autoComplete id="proveedor"  class="form-control" formControlName="proveedor"
                      autocomplete="proveedor"
                      [showEmptyMessage]="true" [style]="{'width':'100%'}" [minLength]="3" [maxlength]="50"
                      class="p-autocomplete" placeholder="Ingresa el proveedor"
                      [inputStyle]="{'width' : '100%','font-style' : 'normal','font-weight' : '400','font-size' : '14px'}">
      </p-autoComplete>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="fechaInicial">Fecha Inicial<span class="req">*</span>:</label>
      <p-calendar styleClass="form-control" id="fechaInicial" formControlName="fechaInicial" [showIcon]="true"
                  dateFormat="dd/mm/yy" placeholder="Fecha Inicial" [minDate]="fechaRango" (onSelect)="validarFechaFinal()">
      </p-calendar>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="fechaFinal">Fecha Inicial<span class="req">*</span>:</label>
      <p-calendar styleClass="form-control" id="fechaFinal" formControlName="fechaFinal" [showIcon]="true"
                  dateFormat="dd/mm/yy" placeholder="Fecha Final" [maxDate]="fechaActual" (onSelect)="validarFechaFinal()">
      </p-calendar>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <span>*Campos obligatorios</span>
    </div>
  </div>
  <div class="flex justify-content-end mb-3">
      <div class="col-md-2">
        <button type="button" style="width: 100%" class="btn btn-default btn-md">Limpiar filtros</button>
      </div>
      <div class="col-md-2">
        <button type="button" style="width: 100%" [disabled]="formulario.invalid" class="btn btn-primary btn-md ml-5">Buscar</button>
      </div>
  </div>
  <div class="flex justify-content-between ">
    <h2 class="subtitulo">Órdenes de entrada</h2>
    <div class="col-md-4">
      <button type="button" style="width:100%" class="btn btn-primary btn-md">Generar ODE</button>
    </div>
  </div>
</form>
<section>
  <p-table styleClass="mt-5 mb-8" [value]="ordenesEntrada"
  [paginator]="ordenesEntrada.length > 0" [rows]="cantElementosPorPagina" [lazy]="true"
  [totalRecords]="totalElementos" [pageLinks]="3" [(first)]="numPaginaActual"
  (onLazyLoad)="seleccionarPaginacion($event)" [resizableColumns]="true" [columnResizeMode]="'expand'">
    <ng-template pTemplate="header">
      <tr>
        <th pResizableColumn scope="col">ID ODE</th>
        <th pResizableColumn scope="col">Folio ODE</th>
        <th pResizableColumn scope="col">Contrato</th>
        <th pResizableColumn scope="col">Proveedor</th>
        <th pResizableColumn scope="col">Folio proveedor</th>
        <th pResizableColumn scope="col">Categoría (Artículo)</th>
        <th pResizableColumn scope="col">Modelo</th>
        <th pResizableColumn scope="col">Velatorio</th>
        <th pResizableColumn scope="col">Costo</th>
        <th pResizableColumn scope="col">Precio</th>
        <th pResizableColumn scope="col">Número de artículos</th>
        <th pResizableColumn scope="col">Fecha ODE</th>
        <th pResizableColumn scope="col">Estatus</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-ordenesEntrada>
      <tr>
        <td pResizableColumn> {{ordenesEntrada.idOde}} </td>
        <td pResizableColumn> {{ordenesEntrada.folioOde}} </td>
        <td pResizableColumn> {{ordenesEntrada.contrato}} </td>
        <td pResizableColumn> {{ordenesEntrada.proveedor}} </td>
        <td pResizableColumn> {{ordenesEntrada.folioProveedor}} </td>
        <td pResizableColumn> {{ordenesEntrada.categoria}} </td>
        <td pResizableColumn> {{ordenesEntrada.modelo}} </td>
        <td pResizableColumn> {{ordenesEntrada.velatorio}} </td>
        <td pResizableColumn> {{ordenesEntrada.costo}} </td>
        <td pResizableColumn> {{ordenesEntrada.precio}} </td>
        <td pResizableColumn> {{ordenesEntrada.numeroArticulos}} </td>
        <td pResizableColumn> {{ordenesEntrada.fechaOde}} </td>
        <td>
          <div class="contenedor-celda-iconos">
            <div class="contenedor-inputswitch flex mr-4">
              <span class="activo mr-3" *ngIf="ordenesEntrada.estatus == 1">Activa</span>
              <span class="activo mr-3" *ngIf="ordenesEntrada.estatus == 2">Cancelada</span>
              <span class="activo mr-3" *ngIf="ordenesEntrada.estatus == 3">Cerrada</span>
            </div>
            <a (click)="abrirPanel($event,ordenesEntrada)" *appValidaRol="['USUARIOS','MODIFICAR']" onCloseOnNavigation>
              <img src="assets/images/imagen-icono-barras-horizontales.svg" alt="icono barras horizontales">
            </a>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <th colspan="13" class="p-2 text-center font-bold text-xl" id="ordenes_sin_resultados">
          No se encontró información relacionada a tu búsqueda.
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="paginatorleft">
      <div class="paginator-template">
        <span class="total-elements">{{ordenesEntrada.length}} de {{totalElementos}}</span>
      </div>
    </ng-template>
    <ng-template pTemplate="paginatorright">
      <div class="paginator-template">
        <div class="export-table">
          <span class="export-table-text">Exportar tabla</span>
          <div class="export-table-icons">
            <img class="icon-export-table"  src="assets/images/imagen-icono-pdf.svg" alt="exportar pdf">
            <img class="icon-export-table" src="assets/images/imagen-icono-excel.svg" alt="exportar excel">
          </div>
        </div>
      </div>
    </ng-template>
  </p-table>
</section>
<p-overlayPanel #overlayPanel>
  <ng-template pTemplate="content">
    <app-overlay-panel-opciones>
      <app-overlay-panel-opcion titulo="Cancelar ODE" (click)="abrirModalCancelarODE()"></app-overlay-panel-opcion>
      <app-overlay-panel-opcion titulo="Cerrar ODE" (click)="abrirModalCerrarODE()"></app-overlay-panel-opcion>
    </app-overlay-panel-opciones>
  </ng-template>
</p-overlayPanel>
<p-dialog [(visible)]="mostrarModalFechaMayor" [modal]="true" [style]="{maxWidth:'544px',width: '100%'}"
          [draggable]="false" [resizable]="false" header="" >
  <ng-template pTemplate="content">
    <div class="flex flex-column align-items-center justify-content-center">
      <span class="text-justify">La fecha inicial no puede ser mayor que la fecha final.</span>
    </div>
  </ng-template>
  <ng-template pTemplate="footer">
    <div class="flex justify-content-center">
      <button class="btn btn-primary btn-md" (click)="mostrarModalFechaMayor = false">Aceptar</button>
    </div>
  </ng-template>
</p-dialog>
