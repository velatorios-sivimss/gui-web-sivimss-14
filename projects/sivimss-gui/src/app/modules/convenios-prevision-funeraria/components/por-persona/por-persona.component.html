<hr class="hr-accordion-content">
<form [formGroup]="personaForm">
  <h2 class="subtitulo">Datos personales</h2>
  <div class="row mb-3">
    <div class="col-md-4">
      <label class="control-label" for="curp">CURP <span class="req">*</span>:</label>
      <input id="curp" class="form-control" formControlName="curp" placeholder="Ingresa el CURP" alphanumericOnly
             maxlength="18" (blur)="consultaCURP()" (keyup)="convertirMayusculas(0)">
      <span class="campo-obligatorio"
            *ngIf="fp.curp?.errors?.required && (fp.curp?.dirty || fp.curp?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-4">
      <label class="control-label" for="rfc">R.F.C :</label>
      <input id="rfc" class="form-control" formControlName="rfc" placeholder="Ingresa el R.F.C." alphanumericOnly
             maxlength="13" (blur)="consultaRFC()" (keyup)="convertirMayusculas(1)">
    </div>
    <div class="col-md-4">
      <label class="control-label" for="matricula">Matrícula :</label>
      <input id="matricula" class="form-control" formControlName="matricula" placeholder="Ingresa la matrícula" numbersOnly
             maxlength="10" (blur)="consultarMatricula()">
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-4">
      <label class="control-label" for="nombre">Nombre <span class="req">*</span>:</label>
      <input id="nombre" class="form-control" formControlName="nombre" placeholder="Ingresa el nombre"
             maxlength="30" (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.nombre?.errors?.required && (fp.nombre?.dirty || fp.nombre?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-4">
      <label class="control-label" for="primerApellido">Primer apellido <span class="req">*</span>:</label>
      <input id="primerApellido" class="form-control" formControlName="primerApellido" placeholder="Ingresa el primer apellido"
             maxlength="20" (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.primerApellido?.errors?.required && (fp.primerApellido?.dirty || fp.primerApellido?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-4">
      <label class="control-label" for="segundoApellido">Segundo apellido <span class="req">*</span>:</label>
      <input id="segundoApellido" class="form-control" formControlName="segundoApellido" placeholder="Ingresa el segundo apellido"
             maxlength="20" (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.segundoApellido?.errors?.required && (fp.segundoApellido?.dirty || fp.segundoApellido?.touched)">Este campo es obligatorio *.</span>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-md-9">
      <label class="control-label" for="correoElectronico">Correo electrónico <span class="req">*</span>:</label>
      <input id="correoElectronico" class="form-control" formControlName="correoElectronico" placeholder="Ingresa el correo electrónico"
             maxlength="45" (blur)="validarCorreoElectornico()" (keyup)="convertirMinusculas(0)">
      <span class="campo-obligatorio"
            *ngIf="fp.correoElectronico?.errors?.required && (fp.correoElectronico?.dirty || fp.correoElectronico?.touched)">Este campo es obligatorio *.</span>
      <span class="campo-obligatorio"
            *ngIf="fp.correoElectronico?.errors?.patter && (fp.correoElectronico?.dirty || fp.correoElectronico?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="telefono">Teléfono <span class="req">*</span>:</label>
      <input id="telefono" class="form-control" formControlName="telefono" placeholder="Ingresa el teléfono"
             maxlength="10" numbersOnly (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.telefono?.errors?.required && (fp.telefono?.dirty || fp.telefono?.touched)">Este campo es obligatorio *.</span>
    </div>


  </div>
  <hr class="hr-accordion-content">
  <h2 class="subtitulo">Dirección</h2>
  <div class="row mb-3">
    <div class="col-md-3">
      <label class="control-label" for="calle">Calle <span class="req">*</span>:</label>
      <input id="calle" class="form-control" formControlName="calle" placeholder="Ingresa la calle"
             maxlength="30" (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.calle?.errors?.required && (fp.calle?.dirty || fp.calle?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="numeroExterior">Número exterior <span class="req">*</span>:</label>
      <input id="numeroExterior" class="form-control" formControlName="numeroExterior" placeholder="Ingresa número exterior"
             maxlength="5" alphanumericOnly (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.numeroExterior?.errors?.required && (fp.numeroExterior?.dirty || fp.numeroExterior?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="numeroInterior">Número interior :</label>
      <input id="numeroInterior" class="form-control" formControlName="numeroInterior" placeholder="Ingresa el número interior"
             maxlength="4" alphanumericOnly>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="cp">C.P. <span class="req">*</span>:</label>
      <input id="cp" class="form-control" formControlName="cp" placeholder="Ingresa el C.P."
             maxlength="5" numbersOnly (blur)="consultarCP()">
      <span class="campo-obligatorio"
            *ngIf="fp.cp?.errors?.required && (fp.cp?.dirty || fp.cp?.touched)">Este campo es obligatorio *.</span>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-md-3">
      <label class="control-label" for="colonia">Asentamiento / Colonia <span class="req">*</span>:</label>
      <input id="colonia" class="form-control" formControlName="colonia" placeholder="Ingresa el asentamiento / colonia"
             maxlength="30" (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.colonia?.errors?.required && (fp.colonia?.dirty || fp.colonia?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="municipio">Municipio <span class="req">*</span>:</label>
      <input id="municipio" class="form-control" formControlName="municipio" placeholder="Ingresa el municipio"
             maxlength="35">
      <span class="campo-obligatorio"
            *ngIf="fp.municipio?.errors?.required && (fp.municipio?.dirty || fp.municipio?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="estado">Estado <span class="req">*</span>:</label>
      <input id="estado" class="form-control" formControlName="estado" placeholder="Ingresa el estado"
             maxlength="35">
      <span class="campo-obligatorio"
            *ngIf="fp.estado?.errors?.required && (fp.estado?.dirty || fp.estado?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="pais">País <span class="req">*</span>:</label>
      <p-dropdown id="pais" class="form-control" formControlName="pais" [options]="pais"
                  placeholder="Selecciona el pais" [filter]="true" filterBy="label" (onChange)="validarFormularioVacio(false,'local')">
      </p-dropdown>
      <span class="campo-obligatorio"
            *ngIf="fp.pais?.errors?.required && (fp.pais?.dirty || fp.pais?.touched)">Este campo es obligatorio *.</span>
    </div>
  </div>
  <hr class="hr-accordion-content">
  <div class="row mb-3">
    <div class="col-md-3" >
      <label class="control-label" for="tipoPaquete">Tipo de paquete <span class="req">*</span>:</label>
      <p-dropdown id="tipoPaquete" class="form-control" formControlName="tipoPaquete" [options]="tipoPaquete"
                  placeholder="Selecciona el paquete" (onChange)="mostrarModalTipoPaquete()" [filter]="true" filterBy="label">
      </p-dropdown>
      <span class="campo-obligatorio"
            *ngIf="fp.tipoPaquete?.errors?.required && (fp.tipoPaquete?.dirty || fp.tipoPaquete?.touched)">Este campo es obligatorio *.</span>
    </div>
    <div class="col-md-3">
      <label class="control-label" for="enfermedadPrexistente">Enfermedad prexistente :</label>
      <p-dropdown id="enfermedadPrexistente" class="form-control" formControlName="enfermedadPrexistente" [options]="enfermedadPrexistente"
                  placeholder="Selecciona la enfermedad prexistente" (onChange)="cambioEnfermedadPrexistente()" [filter]="true" filterBy="label">
      </p-dropdown>
    </div>
    <div class="col-md-3" *ngIf="otroTipoEnferemdad">
      <label class="control-label" for="otraEnferdedad">Otro <span class="req">*</span>:</label>
      <input id="otraEnferdedad" class="form-control" formControlName="otraEnferdedad" placeholder="Otro"
             maxlength="35" (change)="validarFormularioVacio(false,'local')">
      <span class="campo-obligatorio"
            *ngIf="fp.otraEnferdedad?.errors?.required && (fp.otraEnferdedad?.dirty || fp.otraEnferdedad?.touched)">Este campo es obligatorio *.</span>
    </div>
  </div>
</form>
<section class="mt-6" *ngIf="!escenario.includes('modificar')">
  <div class="flex justify-content-between align-items-center mb-5">
    <h2 class="subtitulo">Beneficiarios</h2>
    <button class="ml-4 btn btn-primary btn-lg" onCloseOnNavigation (click)="abrirModalAgregarBeneficiarios()"
    [disabled]="beneficiarios.length == 3" >
      Agregar beneficiarios
    </button>
  </div>

  <ng-container *ngIf="beneficiarios.length == 0">
    <div class="px-4">
      <div class="px-4 py-6 mt-5 border-panel flex justify-content-center">
        <span class="mensaje-agregar-funcionalidad">Agrega hasta 3 (tres) beneficiarios</span>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="beneficiarios.length > 0">
    <app-table-panel>
      <div *ngFor="let beneficiario of beneficiarios" class="flex justify-content-between py-2 px-4 table-panel-row">
        <div class="col-md-4">
          <span> {{beneficiario.nombre}} {{beneficiario.primerApellido}} {{beneficiario.segundoApellido}} </span>
        </div>
        <div class="col-md-3">
          <div class="flex justify-content-end contenedor-celda-iconos">
            <a (click)="abrirModalDetalleBeneficario(beneficiario)">
              <img src="assets/images/imagen-icono-ver.svg" alt="icono ver">
            </a>
            <a (click)="abrirModalModificarBeneficiario(beneficiario)">
              <img src="assets/images/imagen-icono-modificar.svg" alt="icono modificar">
            </a>
            <a (click)="abrirModalEliminarBeneficiario(beneficiario)">
              <img src="assets/images/imagen-icono-eliminar.svg" alt="icono eliminar">
            </a>
          </div>
        </div>
      </div>
    </app-table-panel>
  </ng-container>
</section>

<p-dialog [(visible)]="mostrarModalConfirmacion" [modal]="true"
          [style]="{maxWidth:'544px',width: '100%'}"
          [draggable]="false" [resizable]="false" [showHeader]="true" header="">
  <ng-template pTemplate="content">
    <div class="flex flex-column align-items-center justify-content-center">
      <span class="text-justify">{{infoPaqueteSeleccionado}}</span>
    </div>
  </ng-template>
  <ng-template pTemplate="footer">
    <div class="flex justify-content-center">
      <button class="btn btn-primary btn-md" (click)="mostrarModalConfirmacion = false">Aceptar</button>
    </div>
  </ng-template>
</p-dialog>
