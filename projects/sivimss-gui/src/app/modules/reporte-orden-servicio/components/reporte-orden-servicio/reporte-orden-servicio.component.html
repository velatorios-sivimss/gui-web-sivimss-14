<div class="flex">
<!--  <app-btn-regresar class="mr-2" style="-->
<!--    z-index: 300;-->
<!--    border: solid 2px;-->
<!--    height: 38px;-->
<!--    width: 47px;-->
<!--    padding-left: 6px;-->
<!--    border-radius: 5px;" routerLink="../"></app-btn-regresar>-->
  <app-titulo-principal style="width: 100%" titulo="Reportes"></app-titulo-principal>
</div>
<div class="border-panel">
  <form [formGroup]="filtroForm">
    <div class="row mb-3">
      <div class="col-md-6">
        <label class="control-label" for="nivel">Tipo de reporte:</label>
        <p-dropdown appendTo="body" id="tipoReporte" class="form-control" formControlName="tipoReporte" [options]="tipoReporte"
                    placeholder="Selecciona el tipo de reporte">
        </p-dropdown>
      </div>
      <div class="col-md-6">
        <label class="control-label" for="nivel">Reportes:</label>
        <p-dropdown appendTo="body" id="reporte" class="form-control" formControlName="reporte" [options]="reportes"
                    placeholder="Selecciona el reporte" (onChange)="cambiarReporte()">
        </p-dropdown>
      </div>
    </div>
    <div class="row mb-3">
      <div class="col-md-4">
        <label class="control-label" for="nivel">Nivel<span class="req">*:</span></label>
        <p-dropdown appendTo="body" id="nivel" class="form-control" formControlName="nivel" [options]="niveles"
                    placeholder="Selecciona el nivel">
        </p-dropdown>
        <span class="campo-obligatorio"
              *ngIf="ff.nivel?.errors?.required && (ff.nivel?.dirty || ff.nivel?.touched)">Este campo es obligatorio *.</span>
      </div>
      <div class="col-md-4">
        <label class="control-label" for="delegacion">Delegaci&oacute;n<span class="req">*:</span></label>
        <p-dropdown appendTo="body" id="delegacion" class="form-control" formControlName="delegacion"
                    [options]="delegaciones" placeholder="Selecciona la delegación" (onChange)="cambiarDelegacion()" [filter]="true" filterBy="label">
        </p-dropdown>
        <span class="campo-obligatorio"
              *ngIf="ff.delegacion?.errors?.required && (ff.delegacion?.dirty || ff.delegacion?.touched)">Este campo es obligatorio *.</span>
      </div>
      <div class="col-md-4">
        <label class="control-label" for="velatorio">Velatorio:</label>
        <p-dropdown appendTo="body" id="velatorio" class="form-control" formControlName="velatorio"
                    [options]="velatorios" placeholder="Selecciona el velatorio" [filter]="true" filterBy="label">
        </p-dropdown>
      </div>
    </div>
    <div class="row mb-3">
      <div class="col-md-6" *ngIf="tipoODSBandera">
        <label class="control-label" for="idTipoODS">Tipo de ODS<span class="req">*:</span></label>
        <p-dropdown appendTo="body" id="idTipoODS" class="form-control" formControlName="idTipoODS"
                    [options]="tipoODS" placeholder="Selecciona el tipo de ODS" [filter]="true" filterBy="label">
        </p-dropdown>
        <span class="campo-obligatorio"
              *ngIf="ff.idTipoODS?.errors?.required && (ff.idTipoODS?.dirty || ff.idTipoODS?.touched)">Este campo es obligatorio *.</span>
      </div>
      <div class="col-md-6" *ngIf="numeroODSBandera">
        <label class="control-label" for="numeroOds">Número de ODS:</label>
        <p-autoComplete id="numeroOds" class="form-control" formControlName="numeroOds"
                        [showEmptyMessage]="true" [suggestions]="filtroODS" (completeMethod)="filtrarODS()"
                        [style]="{'width':'100%'}" [minLength]="3" class="p-autocomplete" placeholder="Ingresa el número de ODS" field="label"
                        [inputStyleClass]="'input-autocomplete'"
        >
          <ng-template let-ods pTemplate="item">
            <div class="autocomplete-item">
              <div>{{ods.label}}</div>
            </div>
          </ng-template>
        </p-autoComplete>
      </div>
      <div class="col-md-6" *ngIf="promotorBandera">
        <label class="control-label" for="nivel">Promotor:</label>
        <p-dropdown appendTo="body" id="promotor" class="form-control" formControlName="promotor" [options]="promotor"
                    placeholder="Selecciona el promotor">
        </p-dropdown>
      </div>
      <div class="col-md-6" *ngIf="anioBandera">
        <label class="control-label" for="anio">Año: </label>
        <p-dropdown appendTo="body" id="anio" class="form-control" formControlName="anio"
                    [options]="anio" placeholder="Selecciona el año" [filter]="true" filterBy="label">
        </p-dropdown>
      </div>

      <div class="col-md-6" *ngIf="mesBandera">
        <label class="control-label" for="mes">Mes:</label>
        <p-dropdown appendTo="body" id="mes" class="form-control" formControlName="mes"
                    [options]="mes" placeholder="Selecciona el mes" [filter]="true" filterBy="label">
        </p-dropdown>
      </div>
      <div class="col-md-6" *ngIf="fechaInicialBandera">
        <label class="control-label" for="fechaIni">Fecha Inicial</label>
        <p-calendar styleClass="form-control" id="fechaIni" formControlName="fechaIni" [showIcon]="true"
                    dateFormat="dd/mm/yy" placeholder="Fecha Inicial" [minDate]="fechaRango" (onSelect)="validarFechaFinal()"></p-calendar>
      </div>
      <div class="col-md-6" *ngIf="fechaFinalBandera">
        <label class="control-label" for="fechaFin">Fecha Final</label>
        <p-calendar styleClass="form-control" id="fechaFin" formControlName="fechaFin" [showIcon]="true"
                    dateFormat="dd/mm/yy" placeholder="Fecha Final" [maxDate]="fechaActual" (onSelect)="validarFechaFinal()"></p-calendar>
      </div>
    </div>

    <div class="row mb-3" *ngIf="banderaEstatusODS">
      <div class="col-md-7">
        <label class="control-label">Estatus de ODS<span class="req">*:</span></label>
        <div class="align-items-center">
            <p-checkbox inputId="prerden" formControlName="preorden" styleClass="mr-2" (click)="estatusODS(1)" [binary]="true">
            </p-checkbox>
            <label [for]="'prerden'" class="control-label mr-2">Pre-orden</label>

            <p-checkbox inputId="generada" formControlName="generada" styleClass="mr-2" (click)="estatusODS(2)" [binary]="true">
            </p-checkbox>
            <label [for]="'generada'" class="control-label mr-2">Generada</label>

            <p-checkbox inputId="cancelada" formControlName="cancelada" styleClass="mr-2" (click)="estatusODS(0)" [binary]="true">
            </p-checkbox>
            <label [for]="'cancelada'" class="control-label mr-2">Cancelada</label>

            <p-checkbox inputId="pagada" formControlName="pagada" styleClass="mr-2" (click)="estatusODS(4)" [binary]="true">
            </p-checkbox>
            <label [for]="'pagada'" class="control-label mr-2">Pagada</label>

            <p-checkbox inputId="enTransito" formControlName="enTransito" styleClass="mr-2" (click)="estatusODS(3)" [binary]="true">
            </p-checkbox>
            <label [for]="'enTransito'" class="control-label mr-2">En tránsito</label>

            <p-checkbox inputId="concluida" formControlName="concluida" styleClass="mr-2" (click)="estatusODS(6)" [binary]="true">
            </p-checkbox>
            <label [for]="'concluida'" class="control-label mr-2">Concluida</label>

            <p-checkbox inputId="todos" formControlName="todos" styleClass="mr-2" (click)="estatusODS()" [binary]="true">
            </p-checkbox>
            <label [for]="'todos'" class="control-label mr-2">Todos</label>
        </div>
      </div>
    </div>
  </form>
  <div class="row mb-3">
    <div class="col-md-12 flex justify-content-end">
      <button type="submit" class="btn btn-default btn-md" (click)="limpiarFiltros()">Limpiar filtros</button>
      <button type="submit" class="btn btn-primary btn-md ml-5" (click)="exportarReporte()" >Buscar</button>
    </div>
  </div>
  <div class="flex justify-content-end mb-3">
    <div class="export-table">
      <span class="export-table-text">Exportar tabla</span>
      <div class="flex justify-content-center export-table-icons">
        <img class="icon-export-table" src="assets/images/imagen-icono-pdf.svg" alt="exportar pdf">
        <img class="icon-export-table" src="assets/images/imagen-icono-excel.svg" alt="exportar excel">
      </div>
    </div>
  </div>
</div>


<p-dialog [(visible)]="mostrarModalFechaMayor" [modal]="true"
          [style]="{maxWidth:'544px',width: '100%'}"
          [draggable]="false" [resizable]="false" header="" >
  <ng-template pTemplate="content">
    <div class="flex flex-column align-items-center justify-content-center">
      <span class="text-justify">La fecha inicial no puede ser mayor que la fecha final.</span>
    </div>
  </ng-template>
  <ng-template pTemplate="footer">
    <div class="flex justify-content-center">
      <button class="btn btn-primary btn-md" (click)="mostrarModalFechaMayor = false">Aceptar</button>
    </div>
  </ng-template>
</p-dialog>
