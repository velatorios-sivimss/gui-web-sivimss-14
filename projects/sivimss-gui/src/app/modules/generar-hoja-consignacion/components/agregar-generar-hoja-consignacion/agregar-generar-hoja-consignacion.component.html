<div class="grid">
  <app-btn-regresar class="mr-2 mt-5 col-fixed border-return-button" [routerLink]="['./..']"></app-btn-regresar>
  <app-titulo-principal class="col" titulo="HOJA DE CONSIGNACIÓN"></app-titulo-principal>
</div>

<div class="col text-center">
  <span class="texto-base">Fideicomiso de Beneficios Sociales 46006</span>
</div>

<div class="col text-center">
  <span class="texto-base">C. Versalles #15, Juárez, Cuauhtémoc, 06600 Ciudad de México, CDMX</span>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="background-group">
      <div class="col-md-4">
        <div class="table-panel-column">
          <span>Folio</span>
          <label>Por asignar</label>
        </div>
      </div>

      <div class="col-md-4">
        <div class="table-panel-column">
          <span>Delegación</span>
          <label>{{generarHojaConsignacionService.delegacionSeleccionada?.label}}</label>
        </div>
      </div>

      <div class="col-md-4">
        <div class="table-panel-column">
          <span>Velatorio</span>
          <label>{{generarHojaConsignacionService.velatorioSeleccionado?.label}}</label>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="background-group">
      <div class="col-md-4">
        <div class="table-panel-column">
          <span>Fecha</span>
          <label>{{hoy | date : 'dd/MM/yyyy'}}</label>
        </div>
      </div>

      <div class="col-md-4">
        <div class="table-panel-column">
          <span>Hora</span>
          <label>{{hoy | date: 'HH:mm'}}</label>
        </div>
      </div>

      <div class="col-md-4">
        <div class="table-panel-column">
          <span>Versión</span>
          <label>1.0.0</label>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="border-panel mt-6">
  <p-table appActivarUltimaCeldaSticky styleClass="mt-5 mb-8 table-custom-proveedor" [value]="articulos"
    [rows]="cantElementosPorPagina" [lazy]="true" [totalRecords]="totalElementos" [pageLinks]="3"
    [(first)]="numPaginaActual" (onLazyLoad)="paginar($event)" [resizableColumns]="true" [columnResizeMode]="'expand'">
    <ng-template pTemplate="header">
      <tr class="header-custom-proveedor">
        <th pResizableColumn scope="col">Proveedor</th>
        <th pResizableColumn scope="col">Fecha ODS</th>
        <th pResizableColumn scope="col">Folio ODS</th>
        <th pResizableColumn scope="col">Categoría</th>
        <th pResizableColumn scope="col">Folio único del artículo</th>
        <th pResizableColumn scope="col">Paquete</th>
        <th pResizableColumn scope="col">Costo</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-articulo>
      <tr>
        <td pResizableColumn> {{articulo.proveedor}}</td>
        <td pResizableColumn> {{articulo.fecOds}}</td>
        <td pResizableColumn> {{articulo.folioOds}}</td>
        <td pResizableColumn> {{articulo.categoria}}</td>
        <td pResizableColumn> {{articulo.folioOde}}</td>
        <td pResizableColumn> {{articulo.paquete}}</td>
        <td pResizableColumn> {{articulo.costoConIva}}</td>
      </tr>
    </ng-template>
  </p-table>

  <div class="totales">
    <div class="row">
      <div class="col-md-9">
        <div class="table-panel-column">
        </div>
      </div>

      <div class="col-md-2">
        <div class="table-panel-column">
          <span>Total, de artículos:</span>
          <label>{{totalArticulo}}</label>
        </div>
      </div>

      <div class="col-md-1">
        <div class="table-panel-column">
          <span>Total, costo:</span>
          <label>${{totalCosto}}</label>
        </div>
      </div>
    </div>
  </div>

</div>

<div class="flex justify-content-end mt-6 mb-6">
  <button type="button" class="ml-4 btn btn-primary btn-md" *ngIf="!hojaGenerada"
    [disabled]="mode !== 'create' || articulos.length === 0" (click)="guardar();">
    Guardar
  </button>
  <button type="button" class="ml-4 btn btn-primary btn-md" *ngIf="hojaGenerada || mode !== 'detail'"
    (click)="vistaPrevia();">
    Vista previa
  </button>
</div>

<p-dialog [(visible)]="mostrarModalConfirmacion" [modal]="true" [style]="{maxWidth:'544px',width: '100%'}"
  [draggable]="false" [resizable]="false" header="">
  <ng-template pTemplate="content">
    <div class="flex flex-column align-items-center justify-content-center">
      <span class="text-justify">{{mensajeArchivoConfirmacion}}</span>
    </div>
  </ng-template>
  <ng-template pTemplate="footer">
    <div class="flex justify-content-center">
      <button class="btn btn-primary btn-md" (click)="mostrarModalConfirmacion = false">Aceptar</button>
    </div>
  </ng-template>
</p-dialog>